# 並行コンピューティング技法

- ここではmulti thread/processのテクニック等についてまとめる

0. 並列化モデル
    - タスク分解(タスクの並行処理,task decomposition)
    - データ分解(データの並行処理,data decomposition)

1. thread間機能
[ミューテックス](#mutex)
[リードライトロック](#readers_writer_lock)
[条件変数](#condition)

2. process間機能

---

## <a name='mutex'>mutex</a>

言わずもがな排他機能付す数の`スレッド`から値を参照/更新するのを避け、1スレッドからのアクセスのみに制限する機構

## <a name='readers_writer_lock'>リードライトロック</a>

複数のスレッドで値を参照するのは問題ない。逆に排他をかけてしまうとそこがボトルネックとなってしまう。他スレッドが更新することがあるならば排他が必須となる。
`参照回数が多く、更新回数が圧倒的に少ない共有変数`にはリードライトロック(readers/writer lock)がいい。
これは、スレッドが値を更新する際に、`他の参照スレッドの参照が終了し、更新が終了していることを保証する。`

## <a name='condition'>条件変数</a>

条件変数は任意の条件式と結び付けられ、スレッドに状態(条件式の評価結果)の変化をスレッドに通知します。
スレッドは`pthread_cond_wait()`をコールし、条件変数の変更が通知されるまでブロックする。
状態が変化したら`pthread_cond_signal()`をコールし、条件変数でブロックしているスレッドの実行を再開される。状態変化を通知されたスレッドは、対応するmutexロックを獲得後、
`pthread_cond_wait()`からリターンし、結果に応じて再度条件変数を待つか処理を続けるか判断する。`(通知しても待っているスレッドが存在しなければ通知が破棄される)`。
また、`pthread_cond_broadcast()`は条件変数により待っている全スレッドの実行を再開させる。
