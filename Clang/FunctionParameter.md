# C/C++ ã®å¼•æ•°ã«ã¤ã„ã¦ã¾ã¨ã‚ã‚‹

## å¯å¤‰é•·å¼•æ•°

- å¯å¤‰é•·å¼•æ•°ã«é–¢ã—ã¦ã¯ä»¥ä¸‹ã® 2 ã¤ã®æ–¹æ³•ãŒæŒ™ã’ã‚‰ã‚Œã‚‹ã€‚

  - å¤ãã‹ã‚‰ã‚ã‚‹æ–¹æ³•

    ```cpp
    int printf(const char *fmt, ...)
    {

        // ğŸŒŸ ã“ã“ã®fmtã¯ã‚ãã¾ã§fmtä»¥é™ã®å¼•æ•°ã‚’ã¾ã¨ã‚ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã€
        // ä»¥é™ã®å‡¦ç†ã§fmtã¨apã‚’ä¸€ç·’ã«ä½¿ã†å¿…è¦ã¯ãªã„ã€‚
        va_list ap; /* å¼•æ•°ã®ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆ */
        va_start(ap, fmt);
        int ret = vprintf(fmt, ap);

        // å¤‰æ•°ã®å‹ã€€ã€€=ã€€va_arg(args, å¤‰æ•°ã®å‹)
        // ã£ã¦ã‚„ã‚‹ã“ã¨ã§ã€å¼•æ•°ã‚’é †ç•ªã«å‹ã‚’ã‚­ãƒ£ã‚¹ã¨ã—ã¦æŠœãå‡ºã—ã¦ãã‚‹ã€‚
        va_end(ap); /* va_listã®åˆæœŸåŒ– */
        return ret;
    };
    ```

  - template ã‚’ä½¿ã£ãŸæ–¹æ³•

    ```cpp
    #include <iostream>
    #include <utility>

    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ‘ãƒƒã‚¯ãŒç©ºã«ãªã£ãŸã‚‰çµ‚äº†
    void print() {}

    // ã²ã¨ã¤ä»¥ä¸Šã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚‹ã‚ˆã†ã«ã—ã€
    // å¯å¤‰å¼•æ•°ã‚’å…ˆé ­ã¨ãã‚Œä»¥å¤–ã«åˆ†å‰²ã™ã‚‹
    template <class Head, class... Tail>
    void print(Head&& head, Tail&&... tail)
    {
    // å…ˆé ­ã®å¼•æ•°ã‚’å‡ºåŠ›ã™ã‚‹ã€‚
    std::cout << head << std::endl;
    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ‘ãƒƒã‚¯tailã‚’ã•ã‚‰ã«headã¨tailã«åˆ†å‰²ã€å†èµ·å‘¼ã³å‡ºã—
    print(std::forward<Tail>(tail)...);
    }

    int main()
    {
    print(1, 'a', "hello");
    }
    ```

---

- ä»¥ä¸‹
  - å€¤æ¸¡ã— = å¤‰æ•°ã®å€¤ã‚’åˆ¥ã®å ´æ‰€ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ç•°ãªã‚‹ã€‚
  - å‚ç…§æ¸¡ã— = åŒã˜å€¤ã€åŒã˜ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚‚ã¤å¤‰æ•°ã‚’ä½œã‚Šå‡ºã™ã€‚å¤‰æ•°åã‚’å¤‰ãˆãŸã ã‘ã€‚
  - ã‚¢ãƒ‰ãƒ¬ã‚¹æ¸¡ã— = å¤‰æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å€¤ã¨ã—ã¦ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ç•°ãªã‚‹ã€‚

---

## å‚ç…§æ¸¡ã—

- ä»®ã«ã“ã†æ›¸ã„ãŸã¨ã—ã¦ã€çµæœã¯`0`ã¨ãªã‚‹ã€‚

```cpp
int global_int=0;
int &f(){
    return global_int;
}

int main(){
    int x;
    x = f();
    x++;
    cout << global_int << "\n";
}
```

```cpp
0
```

- `1` ã§ãªãã€`0` ã¨ãªã£ãŸã®ã¯ä»¥ä¸‹ã«æ›¸ã„ãŸã®ã¨åŒã˜å‹•ä½œã®ãŸã‚ã§ã‚ã‚‹ã€‚

```cpp
int global_int=0;

int main(){
    int x;
    x = global_int;
    x++;
    cout << global_int << "\n";
}
```

- ã“ã†æ›¸ãã“ã¨ã§ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨å€¤ã‚’è¿”ã™ã“ã¨ãŒã§ãã‚‹ã€‚

```cpp
#include <iostream>
static int global_int=0;
int &f()
{
    return global_int;
}

int main()
{
    int& x = f();
    x++;
    std::cout << global_int << std::endl;
}
```

## ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹

- printfã«`$`ã‚’ä½¿ã£ã¦ã‚„ã‚‹ã“ã¨ã§ã€å¼•æ•°ã®ä½•ç•ªç›®ã®æ•°å­—ã‚’ä½¿ç”¨ã™ã‚‹ã®ã‹ã‚’ç›´ã§æŒ‡å®šã§ãã‚‹

- ä½¿ã„æ–¹ã¯ã“ã‚“ãªæ„Ÿã˜

```c
printf("%2$d",1,2,3);
```

- å‡ºåŠ›ä¾‹
  - âš ï¸ä»–ã®`%d`ãªã©ã®ã‚¢ã‚¯ã‚»ã‚¹é †ã«å½±éŸ¿ã—ã¦ãªã„

```sh
(base) root@9ea233d8d241:~/Desktop/LeakDetect/OverFlow# cat dyrectPrm.c 
#include<stdio.h>

int main()
{
    printf("%d %d %1$d %d %d %d \narg2: %2$d\n"
		,1,2,3,4,5);
	return 0;
}

(base) root@9ea233d8d241:~/Desktop/LeakDetect/OverFlow# ./a.out
1 2 1 3 4 5 
arg2: 2
(base) root@9ea233d8d241:~/Desktop/LeakDetect/OverFlow# 
```
